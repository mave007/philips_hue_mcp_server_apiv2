# Philips Hue MCP Server - Quick Start Guide

## Initial Setup (First Time Only)

### Step 1: Install Dependencies
```bash
pip install -r requirements.txt
```

### Step 2: Authenticate with Bridge
```bash
python setup_hue_auth.py
```

**What happens:**
1. Script discovers your bridge (or asks for IP)
2. Prompts you to press the **link button** on bridge
3. Generates application key
4. Saves to `hue_config.yaml`

**Important:** Press the physical button on top of your Hue Bridge when prompted!

---

## Daily Usage

### Start MCP Server
```bash
python hue_mcp_server.py
```

### Test Connection
```bash
./test_hue_api.sh
```

---

## Common Operations

### Turn On Living Room Lights
```json
{
  "tool": "hue_search_by_name",
  "args": {"name": "living", "resource_type": "room"}
}
// Get room_id from response, then:
{
  "tool": "hue_control_room",
  "args": {"room_id": "...", "on": true, "brightness": 75}
}
```

### Set Light Color Temperature
```json
{
  "tool": "hue_control_light",
  "args": {
    "light_id": "...",
    "on": true,
    "color_temperature": 300
  }
}
```

**Color Temperature Guide:**
- 153 = Cool White (6500K) - Bright daylight
- 250 = Neutral (4000K) - Office lighting
- 366 = Warm (2700K) - Cozy evening
- 500 = Very Warm (2000K) - Candlelight

### Set RGB Color
```json
{
  "tool": "hue_control_light",
  "args": {
    "light_id": "...",
    "on": true,
    "color_xy": {"x": 0.3, "y": 0.6}
  }
}
```

**Common Colors (xy coordinates):**
- Red: {"x": 0.675, "y": 0.322}
- Green: {"x": 0.409, "y": 0.518}
- Blue: {"x": 0.167, "y": 0.040}
- Yellow: {"x": 0.45, "y": 0.5}
- Purple: {"x": 0.3, "y": 0.15}
- Orange: {"x": 0.6, "y": 0.38}

### List All Lights
```json
{
  "tool": "hue_list_lights_detailed"
}
```

### Find Resources by Name
```json
{
  "tool": "hue_search_by_name",
  "args": {"name": "office"}
}
```

### Activate Scene
```json
{
  "tool": "hue_activate_scene",
  "args": {"scene_id": "..."}
}
```

---

## Configuration File

Location: `hue_config.yaml`

```yaml
bridge:
  ip: "192.168.1.4"      # Your bridge IP
  api_key: "..."         # Generated by setup script

api:
  use_https: true        # Required for API v2
  verify_ssl: false      # Bridge uses self-signed cert

timeouts:
  request: 10
  connection: 5
```

---

## Troubleshooting

### "Bridge IP not configured"
- Run `python setup_hue_auth.py`

### "API key not configured"
- Run `python setup_hue_auth.py`
- Make sure to press link button

### "Link button not pressed"
- Press the button on top of bridge
- You have 30 seconds after pressing
- Try again immediately

### Can't discover bridge
- Check bridge is powered on
- Verify network connection
- Try manual IP entry in setup script

### SSL/Certificate errors
- Normal for Hue Bridge (self-signed cert)
- Make sure `verify_ssl: false` in config

### Light not responding
- Check light is powered on
- Verify light UUID is correct
- Try `hue_list_lights_detailed` to see status

---

## File Overview

```
hue_mcp_server.py                    # Main MCP server
setup_hue_auth.py                    # Authentication setup wizard
hue_config.yaml                      # Configuration file
test_hue_api.sh                      # Connection test script
requirements.txt                     # Python dependencies
README.md                            # Full documentation
doc/DEVICE_DATABASE_README.md
doc/DEVICE_TYPE_IDENTIFICATION.md
doc/DEVICE_VS_LIGHT.md
doc/philips_hue_devices_database.csv
doc/QUICKSTART.md
```

---

## Quick Commands

```bash
# First time setup
python setup_hue_auth.py

# Start server
python hue_mcp_server.py

# Test connection
./test_hue_api.sh

# View config
cat hue_config.yaml

# Check all lights
curl --insecure -H "hue-application-key: $(grep api_key hue_config.yaml | cut -d'"' -f2)" \
  https://$(grep ip: hue_config.yaml | head -1 | cut -d'"' -f2)/clip/v2/resource/light | jq
```

---

## Need Help?

1. Check `README.md` for detailed documentation
2. Review API docs: https://developers.meethue.com/develop/hue-api-v2/
3. Verify bridge firmware is up to date in Hue app
4. Test with CLIP debugger: https://YOUR_BRIDGE_IP/debug/clip.html

---

## API v2 Key Differences from v1

- ✅ Uses HTTPS (not HTTP)
- ✅ Application key in header (not URL)
- ✅ UUIDs for resources (not numeric IDs)
- ✅ `/clip/v2` base path (not `/api/{username}`)
- ✅ Resource-based architecture
- ✅ Server-Sent Events for real-time updates
